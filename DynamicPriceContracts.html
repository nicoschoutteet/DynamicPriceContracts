<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nico Schoutteet">
<meta name="dcterms.date" content="2024-02-22">

<title>Dynamic price contracts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="DynamicPriceContracts_files/libs/clipboard/clipboard.min.js"></script>
<script src="DynamicPriceContracts_files/libs/quarto-html/quarto.js"></script>
<script src="DynamicPriceContracts_files/libs/quarto-html/popper.min.js"></script>
<script src="DynamicPriceContracts_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="DynamicPriceContracts_files/libs/quarto-html/anchor.min.js"></script>
<link href="DynamicPriceContracts_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DynamicPriceContracts_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="DynamicPriceContracts_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="DynamicPriceContracts_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="DynamicPriceContracts_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="DynamicPriceContracts_files/libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-brief-introduction-to-dynamic-prices" id="toc-a-brief-introduction-to-dynamic-prices" class="nav-link active" data-scroll-target="#a-brief-introduction-to-dynamic-prices">A brief introduction to dynamic prices</a></li>
  <li><a href="#whats-the-purpose-of-this-tool" id="toc-whats-the-purpose-of-this-tool" class="nav-link" data-scroll-target="#whats-the-purpose-of-this-tool">What‚Äôs the purpose of this tool?</a></li>
  <li><a href="#lets-get-started-user-input" id="toc-lets-get-started-user-input" class="nav-link" data-scroll-target="#lets-get-started-user-input">Let‚Äôs get started: user input</a></li>
  <li><a href="#a-visual-example-on-how-to-shift-consumption" id="toc-a-visual-example-on-how-to-shift-consumption" class="nav-link" data-scroll-target="#a-visual-example-on-how-to-shift-consumption">A visual example on how to shift consumption</a></li>
  <li><a href="#results-the-savings-potential-of-dynamic-price-contracts" id="toc-results-the-savings-potential-of-dynamic-price-contracts" class="nav-link" data-scroll-target="#results-the-savings-potential-of-dynamic-price-contracts">Results: the savings‚Äô potential of dynamic price contracts</a></li>
  <li><a href="#about-this-tool" id="toc-about-this-tool" class="nav-link" data-scroll-target="#about-this-tool">About this tool</a></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dynamic price contracts</h1>
<p class="subtitle lead">Quantifying the financial impact of responding to the market price signal, and assessing the savings‚Äô potential for residential consumers</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nico Schoutteet </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><i class="bi-linkedin " style="font-size: 20px;color: #0077B5;" role="img" aria-hidden="true"></i> <em>A LinkedIn article with more information on dynamic price contracts can be accessed <a href="https://www.linkedin.com/in/nicoschoutteet/" target="_blank" title="External link to LinkedIn article on dynamic prices">here</a>.</em></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disclaimer regarding the use of this tool and the interpretation of its results
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This tool is the result of a <strong>personal project</strong>, built for educational purposes, to demonstrate the link between residential flexibility and the financial impact of a well-informed choice for dynamic price contracts for the consumption of electricity. The aim of this application is to provide additional insight to the ongoing debate on dynamic prices and (residential) demand flexibility.</p>
<p><strong>This is not a price-comparison tool</strong>: there are no formulas for active contracts in the Belgian retail market, nor links to any suppliers (of dynamic or any other contracts). The results displayed should hence not be considered as guidance on which (type of) contract to consider.</p>
<p>Finally, and most importantly, this is a personal contribution to the debate, done in my free time. Any interpretation of its messages, or results, are the responsibility of the author and the user only, and they should not be interpreted as a formal position, or guidance, of my employer.</p>
</div>
</div>
</div>
<section id="a-brief-introduction-to-dynamic-prices" class="level2">
<h2 class="anchored" data-anchor-id="a-brief-introduction-to-dynamic-prices">A brief introduction to dynamic prices</h2>
<p>Demand response and demand flexibility are key elements in Europe‚Äôs policy to decarbonize the electricity sector, and a crucial enabler of a successful energy transition. In an electric system characterized by high levels of renewable energy sources, the role of demand response (and storage) becomes increasingly important.</p>
<p>In order to provide a financial incentive for (industrial or residential) consumers to adapt their electricity consumption, dynamic price contracts may be an effective way to respond to market (price) signals.</p>
<p>However, the effectiveness of dynamic price contracts to unlock residential flexibilty critically relies on its user:</p>
<ul>
<li><p>consumers need to have a significant share of electricity consumption that may be adapted to the price signal (typically electric vehicles, heat pumps, residential storage systems, etc.); and</p></li>
<li><p>consumers need to actively follow, and respond to, electricity market prices. Alternatively, electricity consumers should have tools and/or systems installed so that its appliances are automatically programmed to run when prices are lowest.</p></li>
</ul>
<p>By responding correctly to the market price signal, the benefits can be identified on two levels:</p>
<ul>
<li><p>for individual consumers: by means of lower cost of electricity consumption</p></li>
<li><p>for society as a whole: by providing a more stable equilibrium between supply and demand, reducing the needs for additional investments, and speeding up the integration of renewables.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are dynamic price contracts?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><em><strong>‚Äòdynamic electricity price contract‚Äô</strong> means an electricity supply contract between a supplier and a final customer that reflects the price variation in the spot markets, including in the day-ahead and intraday markets, at intervals at least equal to the market settlement frequency;</em></p>
<p>~ Electricity Directive (EU) 2019/944, Article 2(15)</p>
<hr>
<p>üßê <em>What‚Äôs that?</em> In non-legalese, an electricity supply contract is dynamic when the unit price (in c‚Ç¨/kWh, or ‚Ç¨/MWh) for the energy component of electricity is based on the actual (day-ahead) wholesale price of the hour during which electricity is consumed.</p>
<p>This is opposed to fixed-price contracts (where a single unit price is determined for the energy component during the contract period) and variable-priced contracts (where the unit price is indexed a number of times during the contract period, typically at monthly or quarterly intervals).</p>
<p>Of course, such dynamic price contracts require that consumers, and suppliers, have access to the hourly electricity offtake data: the consumer should have a digital, or smart, meter installed.</p>
<p>More information regarding dynamic price contracts in Flanders can be found <a href="https://www.vreg.be/nl/faq/dynamische-contracten" target="_blank" title="External link to Flemish regulator's FAQ on dynamic contracts">here</a>.</p>
</div>
</div>
</div>
</section>
<section id="whats-the-purpose-of-this-tool" class="level2">
<h2 class="anchored" data-anchor-id="whats-the-purpose-of-this-tool">What‚Äôs the purpose of this tool?</h2>
<p>This application is built to provide insight in the link between <strong>residential flexibility</strong> (shifting consumption in response to the market price signal) and the <strong>cost of electricity under dynamic price contracts</strong>.</p>
<p>Users have the options to define input parameters related to electricity consumption and flexibility potential. The results of the calculation show how increasing the flexible part of electricity consumption impacts a consumers‚Äô electricity bill.</p>
<p>By adapting the input parameters, the user of this cool can gain an understanding on the impact of dynamic price contracts, the importance of actively monitoring electricity prices and adapting its consumption profile.</p>
</section>
<section id="lets-get-started-user-input" class="level2">
<h2 class="anchored" data-anchor-id="lets-get-started-user-input">Let‚Äôs get started: user input</h2>
<p>The user interface elements below allow to mimic - with certain simplifications - a consumers‚Äô personal situation and preferences. These parameters are used to calculate the results below.</p>
<p><em>Currently, the tool supports user-uploaded consumption profiles, based on the data format from Fluvius‚Äô customers who have smart meters installed (with quarter-hourly data registration active). If you want to find out how to download this data, have a look at the instructions provided by Fluvius. <strong>Please ensure that you download the correct timeframe: from 1 January 2023 to 1 January 2024 (included)</strong>. The generated CSV-file can then be uploaded below.</em></p>
<div class="cell panel-input card bg-light p-2">
<div class="cell-output-display">
<div class="container-fluid">
<div class="row">
<strong>Input parameters regarding consumption profile</strong>
</div>
<br>
<div class="row">
<div class="col-sm-4">
<div id="SelectedProfile" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="SelectedProfile-label">
<label class="control-label" id="SelectedProfile-label" for="SelectedProfile">Select consumption profile:</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="SelectedProfile" value="Default" checked="checked">
<span>Default</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="SelectedProfile" value="User-defined">
<span>User-defined</span>
</label>
</div>
</div>
</div>
</div>
<div class="col-sm-4">
<div data-display-if="input.SelectedProfile == 'Default'" data-ns-prefix="">
<div class="form-group shiny-input-container">
<label class="control-label" id="UserConsumption-label" for="UserConsumption">Annual consumption (kWh):</label>
<input id="UserConsumption" type="number" class="shiny-input-number form-control" value="3500">
</div>
<br>
</div>
<div data-display-if="input.SelectedProfile == 'User-defined'" data-ns-prefix="">
<div class="form-group shiny-input-container">
<label class="control-label" id="UserProfile-label" for="UserProfile">Upload consumption profile:</label>
<div class="input-group">
<label class="input-group-btn input-group-prepend">
<span class="btn btn-default btn-file">
Browse...
<input id="UserProfile" class="shiny-input-file" name="UserProfile" type="file" style="position: absolute !important; top: -99999px !important; left: -99999px !important;">
</span>
</label>
<input type="text" class="form-control" placeholder="No file selected" readonly="readonly">
</div>
<div id="UserProfile_progress" class="progress active shiny-file-input-progress">
<div class="progress-bar"></div>
</div>
</div>
</div>
</div>
<div class="col-sm-4">
<div data-display-if="input.SelectedProfile == 'Default'" data-ns-prefix="">
<div id="DefaultConsumptionText" class="shiny-html-output"></div>
<br>
</div>
<div data-display-if="input.SelectedProfile == 'User-defined'" data-ns-prefix="">
<strong>Annual consumption (kWh):</strong>
<div id="UserConsumptionText" class="shiny-html-output"></div>
</div>
</div>
</div>
<hr>
<div class="row">
<strong>Input parameters regarding residential flexibility</strong>
</div>
<br>
<div class="row">
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="Flexibility-label" for="Flexibility">Flexible share of consumption:</label>
<input class="js-range-slider" id="Flexibility" data-skin="shiny" data-min="0" data-max="100" data-from="25" data-step="1" data-grid="false" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-postfix="%" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="FlexibleHours-label" for="FlexibleHours">Number of hours with flexible consumption:</label>
<input id="FlexibleHours" type="number" class="shiny-input-number form-control" value="6" min="1" max="12">
</div>
</div>
<div class="col-sm-4"></div>
</div>
</div>
</div>
</div>
<p><em>The results below will be automatically updated to reflect the user‚Äôs input parameters. Please be patient, the underlying calculations need some time to run before the results can be visualized.</em></p>
</section>
<section id="a-visual-example-on-how-to-shift-consumption" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="a-visual-example-on-how-to-shift-consumption">A visual example on how to shift consumption</h2>
<p><em>The way in which this tool calculates the total energy cost of a dynamic price contracts, with or without shift in consumption, is demonstrated visually in the two figures and table below. You can select a date at random in the year 2023 to see how consumption can be shifted from high-priced to low-priced hours, and vice versa, and the impact this has on the total cost of the consumption profile.</em></p>
<div class="cell">
<div class="cell-output-display">
<div id="SelectedDate" class="shiny-date-input form-group shiny-input-container">
<label class="control-label" id="SelectedDate-label" for="SelectedDate">Select a date:</label>
<input type="text" class="form-control" aria-labelledby="SelectedDate-label" title="Date format: yyyy-mm-dd" data-date-language="en" data-date-week-start="0" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-min-date="2023-01-01" data-max-date="2023-12-31" data-initial-date="2023-01-01" data-date-autoclose="true" data-date-dates-disabled="null" data-date-days-of-week-disabled="null">
</div>
</div>
</div>
<p><a href="#fig-daily-prices">Figure&nbsp;1</a> shows the hourly prices on the selected date. The highest-priced hours are indicated with ‚ÄúH‚Äù, the lowest-priced hours are indicated with ‚ÄúL‚Äù.</p>
<div class="cell page-columns page-full">
<div id="fig-daily-prices" class="quarto-figure quarto-figure-center column-body-outset anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;1: Daily profile of day-ahead prices (in ‚Ç¨/MWh)</figcaption>
<div class="girafe html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="DailyPricesPlot" style="width:100%;height:500px;"></div>
</figure>
</div>
</div>
<p>The electricity consumption on the selected date, according to the selected consumption profile, is shown in <a href="#fig-daily-consumption">Figure&nbsp;2</a>. The blue line shows the actual consumption (either user-defined or according to the RLP), while the green line shows consumption shifted with the selected flexibility percentage from the highest-priced to the lowest-^priced hours. The red line indicates the inverse situation: consumption is shifted from the lowest-priced to the highest-priced hours.</p>
<div class="cell page-columns page-full">
<div id="fig-daily-consumption" class="quarto-figure quarto-figure-center column-body-outset anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2: Daily profile of electricity consumption (in kWh)</figcaption>
<div class="girafe html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="DailyConsumptionPlot" style="width:100%;height:500px;"></div>
</figure>
</div>
</div>
<p>The total cost of electricity consumption on the selected date is calculated in the table below. This is done by multiplying the market price in <a href="#fig-daily-prices">Figure&nbsp;1</a> with the different consumption profiles (blue, green, red) in <a href="#fig-daily-consumption">Figure&nbsp;2</a>.</p>
<div class="cell">
<div class="cell-output-display">

<div class="reactable html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" data-reactable-output="DailyConsumptionTable" id="DailyConsumptionTable" style="width:auto;height:auto;"></div>
</div>
</div>
</section>
<section id="results-the-savings-potential-of-dynamic-price-contracts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="results-the-savings-potential-of-dynamic-price-contracts">Results: the savings‚Äô potential of dynamic price contracts</h2>
<p>In <a href="#fig-daily-calendar">Figure&nbsp;3</a>, the total daily energy cost without consumption shift is compared to the total daily cost where consumption is shifted with 100% during the selected hours. Days with a higher savings potential (i.e.&nbsp;the cost of shifted consumption is much lower than the cost of the actual consumption) have a darker shade of green, days with lower potential are a lighter shade. Days where the savings‚Äô potential exceeds 100%, are indicated in dark green.</p>
<div class="cell page-columns page-full">
<div id="fig-daily-calendar" class="quarto-figure quarto-figure-center column-body-outset anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;3: Savings potential by shifting 100% consumption each day</figcaption>
<div class="girafe html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="DailyCalendarPotential" style="width:100%;height:500px;"></div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div class="reactable html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" data-reactable-output="YearlyConsumptionTable" id="YearlyConsumptionTable" style="width:auto;height:auto;"></div>
</div>
</div>
<p>Finally, the total cost of the energy component is shown in function of the share of the consumption that is shifted (in either direction), in <a href="#fig-flex-results">Figure&nbsp;4</a>.</p>
<div class="cell page-columns page-full">
<div id="fig-flex-results" class="quarto-figure quarto-figure-center column-body-outset anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;4: Yearly cost of dynamic price contract in function of flexibility</figcaption>
<div class="girafe html-widget html-widget-output shiny-report-size html-fill-item-overflow-hidden html-fill-item" id="FlexResults" style="width:100%;height:500px;"></div>
</figure>
</div>
</div>
</section>
<section id="about-this-tool" class="level2">
<h2 class="anchored" data-anchor-id="about-this-tool">About this tool</h2>
<p>This application was generated using R, Quarto and Shiny apps. It uses publicly available data (Synergrid‚Äôs Real Load Profiles and Entso-E Transparency Platform‚Äôs day-ahead prices for Belgium).</p>
<p>The tool is a personal project, written by Nico Schoutteet. Questions, comments and suggestions may be addressed to the author via LinkedIn or e-mail.</p>
<p><i class="bi-linkedin " style="font-size: 20px;color: #0077B5;" role="img" aria-hidden="true"></i> <a href="https://www.linkedin.com/in/nicoschoutteet/" target="_blank" title="External link to LinkedIn profile">LinkedIn profile</a></p>
<p><i class="bi-mailbox " style="font-size: 20px;" role="img" aria-hidden="true"></i> <a href="mailto:n.schoutteet@gmail.com">E-mail</a></p>
<p>The source code for this tool is available via GitHub.</p>
<p><i class="bi-github " style="font-size: 20px;" role="img" aria-hidden="true"></i> <a href="https://github.com/nicoschoutteet/DynamicPrices" target="_blank" title="Link to GitHub repository">GitHub repository</a></p>
<p>
<script type="application/shiny-prerendered" data-context="server">
library(tidyverse)
library(shiny)
library(ggiraph)
library(reactable)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
options(shiny.maxRequestSize=30*1024^2)
source("DataImport.R")
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$DefaultConsumptionText <- renderText({
  paste0("<em>The consumption of ", 
         format(input$UserConsumption, big.mark = "."), 
         " kWh will be allocated according to Synergrid's RLP0.<\u002fem>")
})

output$UserConsumptionText <- renderText({
  format(round(sum(df()$Consumption, na.rm = TRUE), 1),
         big.mark = ".", decimal.mark = ",")
  })

df <- reactive({
  
  if(input$SelectedProfile == "Default") {
  
  df_rd %>% 
      mutate(Consumption = Profile * input$UserConsumption) %>% 
      group_by(as.Date(DateTime, tz = "Europe/Brussels")) %>% 
      mutate(HighLow = case_when(rank(-Price, 
                                      ties.method = "random") %in% 
                                   1:input$FlexibleHours ~ "H",
                                 rank(Price,
                                      ties.method = "random") %in% 
                                   1:input$FlexibleHours ~ "L",
                                 TRUE ~ NA),
             FlexConsumptionGood = case_when(HighLow == "H"
                                             ~ Consumption * 
                                               (1 - input$Flexibility * .01),
                                             HighLow == "L"
                                             ~ Consumption + 
                                               sum(Consumption[HighLow == "H"],
                                                   na.rm = TRUE) * 
                                               input$Flexibility * .01 / 
                                               input$FlexibleHours,
                                             TRUE ~ Consumption),
             FlexConsumptionBad = case_when(HighLow == "L"
                                             ~ Consumption * 
                                              (1 - input$Flexibility * .01),
                                             HighLow == "H"
                                             ~ Consumption + 
                                               sum(Consumption[HighLow == "L"],
                                                   na.rm = TRUE) * 
                                              input$Flexibility * .01  / 
                                              input$FlexibleHours,
                                             TRUE ~ Consumption))
    
  } else if (input$SelectedProfile == "User-defined") {
    
    df_rd %>% 
      select(-Profile) %>% 
      left_join(
        read_csv2(input$UserProfile$datapath) %>%
          mutate(DateTime = with_tz(as.POSIXct(paste(as.Date(
            `Van Datum`, "%d-%m-%Y"), `Van Tijdstip`)),
            tz = "Europe/Brussels")) %>%
          filter(Register %in% c("Afname Nacht", "Afname Dag")) %>% 
      group_by(DateTime = floor_date(DateTime, "1 hour")) %>% 
      summarize(Consumption = sum(Volume, na.rm = TRUE)) %>% 
      ungroup() %>% 
      arrange(DateTime) %>% 
      mutate(Profile = Consumption / sum(Consumption, na.rm = TRUE))
      ) %>% 
      select(DateTime, Price, Profile, Consumption) %>% 
      group_by(as.Date(DateTime, tz = "Europe/Brussels")) %>% 
      mutate(HighLow = case_when(rank(-Price, 
                                      ties.method = "random") %in% 
                                   1:input$FlexibleHours ~ "H",
                                 rank(Price,
                                      ties.method = "random") %in% 
                                   1:input$FlexibleHours ~ "L",
                                 TRUE ~ NA),
             FlexConsumptionGood = case_when(HighLow == "H"
                                             ~ Consumption * 
                                               (1 - input$Flexibility * .01),
                                             HighLow == "L"
                                             ~ Consumption + 
                                               sum(Consumption[HighLow == "H"],
                                                   na.rm = TRUE) * 
                                               input$Flexibility * .01 / 
                                               input$FlexibleHours,
                                             TRUE ~ Consumption),
             FlexConsumptionBad = case_when(HighLow == "L"
                                             ~ Consumption * 
                                              (1 - input$Flexibility * .01),
                                             HighLow == "H"
                                             ~ Consumption + 
                                               sum(Consumption[HighLow == "L"],
                                                   na.rm = TRUE) * 
                                              input$Flexibility * .01  / 
                                              input$FlexibleHours,
                                             TRUE ~ Consumption))
  } 
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$DailyPricesPlot <- renderGirafe({
  
  plot <- ggplot(data = filter(df(), as.Date(DateTime, tz = "Europe/Brussels")
                       == as.Date(input$SelectedDate, tz = "Europe/Brussels")),
         mapping = aes(x = hour(DateTime), y = Price)) +
    geom_hline(yintercept = 0,
               linewidth = .15, linetype = "solid", colour = "black") +
    geom_text(mapping = aes(y = Price + 1, label = HighLow),
               vjust = 0, size = 3, 
               colour = "black") +
    geom_step(direction = "mid", colour = "#7eb0d5") +
    geom_point_interactive(shape = 19, colour = "#7eb0d5", hover_nearest = TRUE,
                           mapping = aes(group = 1,
                                         data_id = DateTime,
                                         tooltip = paste0("Day ahead price on ",
                                                         format(DateTime,
                                                                "%d %B %Y %H:%M"),
                                                         ":\n",
                                                         format(round(Price, 1),
                                                                decimal.mark =",",
                                                                big.mark = "."),
                                                         " EUR/MWh"))) +
    scale_x_continuous(name = element_blank(),
                       breaks = seq(0, 23, 1)) +
    scale_y_continuous(name = element_blank(),
                       labels = scales::number_format(suffix = " ‚Ç¨/MWh")) +
    theme_minimal() +
    theme(panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_line(linewidth = .1,
                                            linetype = "dashed",
                                            colour = "darkgrey"))
  
  girafe(ggobj = plot,
         width_svg = 10,
         height_svg = 6,
         options = list(
           opts_selection(
             type = "single"))) %>% 
    girafe_options(opts_zoom(min = 1, max = 5))
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$DailyConsumptionPlot <- renderGirafe({
  
  plot <- ggplot(data = filter(df(), as.Date(DateTime, tz = "Europe/Brussels")
                       == as.Date(input$SelectedDate, tz = "Europe/Brussels")),
         mapping = aes(x = hour(DateTime))) +
    geom_step(mapping = aes(y = FlexConsumptionGood),
              direction = "mid", colour = "#b2e061") +
    geom_point_interactive(shape = 19, colour = "#b2e061", hover_nearest = TRUE,
                           mapping = aes(y = FlexConsumptionGood,
                                         group = 1,
                                         data_id = DateTime,
                                         tooltip = paste0(
                                           "Electricity offtake including ",
                                           input$Flexibility, 
                                           "%\nshift in correct direction:\n",
                                           format(round(FlexConsumptionGood, 1),
                                                  big.mark = ".", 
                                                  decimal.mark = ","),
                                           " kWh."))) +
    geom_step(mapping = aes(y = FlexConsumptionBad),
              direction = "mid", colour = "#fd7f6f") +
    geom_point_interactive(shape = 19, colour = "#fd7f6f", hover_nearest = TRUE,
                           mapping = aes(y = FlexConsumptionBad,
                                         group = 1,
                                         data_id = DateTime,
                                         tooltip = paste0(
                                           "Electricity offtake including ",
                                           input$Flexibility, 
                                           "%\nshift in wrong direction:\n",
                                           format(round(FlexConsumptionBad, 1),
                                                  big.mark = ".", 
                                                  decimal.mark = ","),
                                           " kWh."))) +
    geom_step(mapping = aes(y = Consumption),
              direction = "mid", colour = "#7eb0d5") +
    geom_point_interactive(shape = 19, colour = "#7eb0d5", hover_nearest = TRUE,
                           mapping = aes(y = Consumption,
                                         group = 1,
                                         data_id = DateTime,
                                         tooltip = paste0(
                                           "Actual electricity offtake\n",
                                           "without shift:\n",
                                           format(round(Consumption, 1),
                                                  big.mark = ".", 
                                                  decimal.mark = ","),
                                           " kWh."))) +
    scale_x_continuous(name = element_blank(),
                       breaks = seq(0, 23, 1)) +
    scale_y_continuous(name = element_blank(),
                       labels = scales::number_format(suffix = " kWh",
                                                      big.mark = ".",
                                                      decimal.mark = ",")) +
    theme_minimal() +
    theme(panel.grid.major.x = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_line(linewidth = .1,
                                            linetype = "dashed",
                                            colour = "darkgrey"))
  
  girafe(ggobj = plot,
         width_svg = 10,
         height_svg = 6,
         options = list(
           opts_selection(
             type = "single"))) %>% 
    girafe_options(opts_zoom(min = 1, max = 5))
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$DailyConsumptionTable <- renderReactable({
  
  df() %>% 
    filter(as.Date(DateTime, tz = "Europe/Brussels") 
           == as.Date(input$SelectedDate, tz = "Europe/Brussels")) %>% 
    mutate("NoShift" = Price * Consumption,
           "GoodShift" = Price * FlexConsumptionGood,
           "BadShift" = Price * FlexConsumptionBad) %>% 
    group_by(Year = year(DateTime)) %>%
    summarize(NoShift = sum(NoShift, na.rm = TRUE),
              GoodShift = sum(GoodShift, na.rm = TRUE),
              BadShift = sum(BadShift, na.rm = TRUE),
              Consumption = sum(Consumption, na.rm = TRUE)) %>%
    pivot_longer(-c(Year, Consumption), names_to = "Contract", values_to = "Cost") %>%
    mutate(Contract = recode(Contract,
                            "NoShift" = 
                              "Dynamic without consumption shift",
                            "GoodShift" = 
                              "Dynamic with shift in right direction",
                            "BadShift" = 
                              "Dynamic with shift in wrong direction"),
      ConsumptionShift = c(0, 
                           input$Flexibility * .01, 
                           input$Flexibility * .01),
      TotalCost = Cost / 1000,
      UnitCost = Cost / Consumption / 10) %>% 
    select(Contract, ConsumptionShift, 
           Consumption, TotalCost, UnitCost) %>% 
    reactable(
      columns = list(
      Contract = colDef(name = ""),
      ConsumptionShift = colDef(name = "Consumption shift",
        format = colFormat(percent = TRUE,
                           locales = "NL-be")),
      Consumption = colDef(name = "Daily consumption",
        format = colFormat(separators = TRUE,
                           suffix = " kWh",
                           digits = 2,
                           locales = "NL-be")),
      TotalCost = colDef(name = "Yearly total cost",
        format = colFormat(suffix = " ‚Ç¨",
                           digits = 2,
                           locales = "NL-be")),
      UnitCost = colDef(name = "Yearly unit cost (volume-weighted)",
        format = colFormat(suffix = " c‚Ç¨/kWh",
                           digits = 2,
                           locales = "NL-be"))
    )
    )
  
}) 

</script>
 
<script type="application/shiny-prerendered" data-context="server">
df_daily <- reactive({
  
  df() %>% 
    select(DateTime, Price, Profile, Consumption, HighLow) %>% 
     group_by(as.Date(DateTime, tz = "Europe/Brussels")) %>% 
      mutate(FlexConsumptionGood = case_when(HighLow == "H"
                                             ~ Consumption * 
                                               (1 - 100 * .01),
                                             HighLow == "L"
                                             ~ Consumption + 
                                               sum(Consumption[HighLow == "H"],
                                                   na.rm = TRUE) * 
                                               100 * .01 / 
                                               input$FlexibleHours,
                                             TRUE ~ Consumption),
             ActualCost = Consumption * Price,
             PossibleCost = FlexConsumptionGood * Price) %>% 
    ungroup() %>% 
    group_by(Date = as.Date(DateTime, tz = "Europe/Brussels")) %>% 
    summarize(ActualCost = sum(ActualCost, na.rm = TRUE),
              PossibleCost = sum(PossibleCost, na.rm = TRUE)) %>% 
    ungroup() %>% 
    mutate(Potential = -(ActualCost - PossibleCost) / abs(ActualCost),
           Week = case_when(isoweek(Date) >= 52 & month(Date) == 1 ~ 0,
                            TRUE ~ isoweek(Date)),
           Weekday = wday(Date, week_start = 1)) %>% 
    select(Date, Weekday, Week, Potential)
  
})

output$DailyCalendarPotential <- renderGirafe({
  
  plot <- ggplot(data = df_daily(),
         mapping = aes(x = Weekday,
                       y = Week,
                       fill = Potential)) +
    geom_tile_interactive(mapping = aes(tooltip = paste0("Savings potential on ",
                                                         format(Date,
                                                                "%d %B %Y"),
                                                         ":\n",
                                                         scales::percent(
                                                           Potential,
                                                           accuracy = .1,
                                                           decimal.mark = ",",
                                                           big.mark = ".")))) +
    scale_x_continuous(name = element_blank(),
                       breaks = seq(1, 7, 1),
                       labels = c("M", "T", "W", "T", "F", "S", "S")) +
    scale_y_reverse(name = element_blank()) +
    scale_fill_gradient_interactive(high = "white",
                                    low = "#90B44E",
                                    limits = c(-1, 0),
                                    na.value = "#485A27",
                                    labels = 
                                      scales::percent_format(accuracy = 1)) +
    facet_wrap(~month(Date, label = TRUE),
               scales = "free_y") +
    theme_minimal() +
    theme(panel.grid = element_blank(),
          axis.text.y = element_blank())
  
  girafe(ggobj = plot,
         width_svg = 10,
         height_svg = 6,
         options = list(
           opts_selection(
             type = "single"))) %>% 
    girafe_options(opts_zoom(min = 1, max = 5))
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$YearlyConsumptionTable <- renderReactable({
  
  df() %>% 
    mutate("NoShift" = Price * Consumption,
           "GoodShift" = Price * FlexConsumptionGood,
           "BadShift" = Price * FlexConsumptionBad) %>% 
    group_by(Year = year(DateTime)) %>%
    summarize(NoShift = sum(NoShift, na.rm = TRUE),
              GoodShift = sum(GoodShift, na.rm = TRUE),
              BadShift = sum(BadShift, na.rm = TRUE),
              Consumption = sum(Consumption, na.rm = TRUE)) %>%
    pivot_longer(-c(Year, Consumption), names_to = "Contract", values_to = "Cost") %>%
    mutate(Contract = recode(Contract,
                            "NoShift" = 
                              "Dynamic without consumption shift",
                            "GoodShift" = 
                              "Dynamic with shift in right direction",
                            "BadShift" = 
                              "Dynamic with shift in wrong direction"),
      ConsumptionShift = c(0, 
                           input$Flexibility * .01, 
                           input$Flexibility * .01),
      TotalCost = Cost / 1000,
      UnitCost = Cost / Consumption / 10) %>% 
    select(Contract, ConsumptionShift, 
           Consumption, TotalCost, UnitCost) %>% 
    reactable(
      columns = list(
      Contract = colDef(name = ""),
      ConsumptionShift = colDef(name = "Consumption shift",
        format = colFormat(percent = TRUE,
                           locales = "NL-be")),
      Consumption = colDef(name = "Yearly consumption",
        format = colFormat(separators = TRUE,
                           suffix = " kWh",
                           digits = 2,
                           locales = "NL-be")),
      TotalCost = colDef(name = "Yearly total cost",
        format = colFormat(suffix = " ‚Ç¨",
                           digits = 2,
                           locales = "NL-be")),
      UnitCost = colDef(name = "Yearly unit cost (volume-weighted)",
        format = colFormat(suffix = " c‚Ç¨/kWh",
                           digits = 2,
                           locales = "NL-be"))
    )
    )
  
}) 
</script>
 
<script type="application/shiny-prerendered" data-context="server">
df_flexresults <- reactive({
  
  df_temp <- tibble()

  for (f in seq(0, 1, .1)) {
  
  df_temp <- df() %>% 
    select(DateTime, Price, Profile, Consumption) %>% 
    group_by(Day = as.Date(DateTime, "Europe/Brussels")) %>% 
    mutate(HighLow = case_when(rank(-Price, ties.method = "random") %in% 
                                 1:input$FlexibleHours ~ "H",
                               rank(Price, ties.method = "random") %in% 
                                 1:input$FlexibleHours ~ "L",
                               TRUE ~ NA),
           FlexConsGood = case_when(HighLow == "H" ~ Consumption * (1 - f),
                                    HighLow == "L" ~ Consumption + (sum(Consumption[HighLow == "H"], na.rm = TRUE) * f) / input$FlexibleHours,
                                    TRUE ~ Consumption),
           FlexConsBad = case_when(HighLow == "L" ~ Consumption * (1 - f),
                                   HighLow == "H" ~ Consumption + (sum(Consumption[HighLow == "L"], na.rm = TRUE) * f) / input$FlexibleHours,
                                   TRUE ~ Consumption)) %>% 
    ungroup() %>% 
    mutate(FlexGood = FlexConsGood * Price / 1000,
           FlexBad = FlexConsBad * Price / 1000) %>% 
    summarize(FlexGood = sum(FlexGood, na.rm = TRUE),
              FlexBad = sum(FlexBad, na.rm = TRUE)) %>% 
    mutate(Percentage = f) %>% 
    rbind(df_temp)
  }
  
  df_temp
  
})

df_longflex <- reactive({
  df_flexresults() %>%
  pivot_longer(-Percentage, names_to = "Direction", values_to = "Cost") %>%
  mutate(Direction = str_remove(Direction, "Flex"))
})

output$FlexResults <- renderGirafe({

  plot <- ggplot(data = df_longflex(),
                 mapping = aes(x = Percentage, y = Cost, 
                               colour = Direction, fill = Direction)) +
  geom_ribbon(inherit.aes = FALSE,
              data = df_flexresults(),
              mapping = aes(x = Percentage, ymax = FlexBad, ymin = FlexGood),
              fill = "lightgrey", alpha = .4) +
  geom_line() +
  geom_point_interactive(colour = "white", shape = 21, size = 2.5,
             mapping = aes(tooltip = paste0("Yearly cost with ",
                                            scales::percent(Percentage, 
                                                            accuracy = 1),
                                            " consumption shift\n",
                                            "in the ",
                                            tolower(Direction),
                                            " direction:\n",
                                            format(round(Cost, 1),
                                                   big.mark = ".",
                                                   decimal.mark = ","),
                                            " ‚Ç¨"))) +
  geom_point_interactive(inherit.aes = FALSE,
                         mapping = aes(x = 0, 
                                       y = Cost[Percentage == 0 & 
                                                  Direction == "Good"],
                                       tooltip = paste0("Yearly cost with 0% consumption shift:\n",
                                            format(round(Cost, 1),
                                                   big.mark = ".",
                                                   decimal.mark = ","),
                                            " ‚Ç¨")),
                         colour = "white", fill = "darkgrey", shape = 21, 
                         size = 2.5) +
  scale_fill_manual(name = "Shift in consumption pattern",
                    values = c("Bad" = "#fd7f6f",
                               "Good" = "#b2e061"),
                    labels = c("Bad" = "in the bad direction",
                               "Good" = "in the good direction")) +
  scale_colour_manual(name = "Shift in consumption pattern",
                      values = c("Bad" = "#fd7f6f",
                               "Good" = "#b2e061"),
                      labels = c("Bad" = "in the bad direction",
                               "Good" = "in the good direction")) +
  geom_segment(inherit.aes = FALSE,
               data = filter(df_flexresults(), Percentage == 1),
               mapping = aes(x = 1.04, xend = 1.04, 
                             y = FlexBad * .98, yend = FlexGood * 1.03),
               arrow = arrow(length = unit(.1, "cm"),
                             ends = "both", type = "closed"),
               colour = "darkgrey", linewidth = .25) +
  geom_text(inherit.aes = FALSE,
            data = filter(df_longflex(), Percentage == 1),
            mapping = aes(x = 1.02, y = Cost, 
                          label = paste0(round(Cost, 1), " ‚Ç¨"), 
                          colour = Direction),
            hjust = 0, size = 3, show.legend = FALSE) +
  scale_x_continuous(name = element_blank(),
                     breaks = seq(0, 1, .1),
                     labels = scales::percent_format(accuracy = 1)) +
  scale_y_continuous(name = element_blank(),
                     breaks = seq(0, 1000, 50),
                     labels = scales::number_format(suffix = " ‚Ç¨")) +
    coord_cartesian(xlim = c(0, 1),
                  clip = "off") +
    theme_minimal() +
    theme(plot.margin = margin(5.5, 55, 5.5, 5.5, "pt"),
          panel.grid.minor.y = element_blank(),
          panel.grid.minor.x = element_blank(),
          panel.grid.major.x = element_blank(),
          legend.position = "bottom")
  
  girafe(ggobj = plot,
         width_svg = 10,
         height_svg = 6,
         options = list(
           opts_selection(
             type = "single"))) %>% 
    girafe_options(opts_zoom(min = 1, max = 5))
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.4.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","accessibility/js/bootstrap-accessibility.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css","accessibility/css/bootstrap-accessibility.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-bundle"]},{"type":"character","attributes":{},"value":["5.16.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-bundle-5.16.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-bundle.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-lasso"]},{"type":"character","attributes":{},"value":["0.0.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-lasso-0.0.5"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-lasso.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["save-svg-as-png"]},{"type":"character","attributes":{},"value":["1.4.17"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/save-svg-as-png-1.4.17"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["save-svg-as-png.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["flatbush"]},{"type":"character","attributes":{},"value":["4.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/flatbush-4.0.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["flatbush.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ggiraphjs"]},{"type":"character","attributes":{},"value":["0.4.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/ggiraphjs-0.4.6"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraphjs.min.js"]},{"type":"character","attributes":{},"value":["ggiraphjs.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["girafe-binding"]},{"type":"character","attributes":{},"value":["0.8.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["girafe.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-bundle"]},{"type":"character","attributes":{},"value":["5.16.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-bundle-5.16.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-bundle.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-lasso"]},{"type":"character","attributes":{},"value":["0.0.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-lasso-0.0.5"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-lasso.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["save-svg-as-png"]},{"type":"character","attributes":{},"value":["1.4.17"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/save-svg-as-png-1.4.17"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["save-svg-as-png.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["flatbush"]},{"type":"character","attributes":{},"value":["4.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/flatbush-4.0.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["flatbush.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ggiraphjs"]},{"type":"character","attributes":{},"value":["0.4.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/ggiraphjs-0.4.6"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraphjs.min.js"]},{"type":"character","attributes":{},"value":["ggiraphjs.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["girafe-binding"]},{"type":"character","attributes":{},"value":["0.8.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["girafe.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["core-js"]},{"type":"character","attributes":{},"value":["2.5.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/core-js"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shim.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["react"]},{"type":"character","attributes":{},"value":["18.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/react"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["react.min.js","react-dom.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactwidget"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/react-tools"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["react-tools.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactable"]},{"type":"character","attributes":{},"value":["0.4.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.4.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactable-binding"]},{"type":"character","attributes":{},"value":["0.4.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.4.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-bundle"]},{"type":"character","attributes":{},"value":["5.16.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-bundle-5.16.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-bundle.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-lasso"]},{"type":"character","attributes":{},"value":["0.0.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-lasso-0.0.5"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-lasso.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["save-svg-as-png"]},{"type":"character","attributes":{},"value":["1.4.17"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/save-svg-as-png-1.4.17"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["save-svg-as-png.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["flatbush"]},{"type":"character","attributes":{},"value":["4.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/flatbush-4.0.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["flatbush.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ggiraphjs"]},{"type":"character","attributes":{},"value":["0.4.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/ggiraphjs-0.4.6"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraphjs.min.js"]},{"type":"character","attributes":{},"value":["ggiraphjs.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["girafe-binding"]},{"type":"character","attributes":{},"value":["0.8.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["girafe.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["core-js"]},{"type":"character","attributes":{},"value":["2.5.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/core-js"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shim.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["react"]},{"type":"character","attributes":{},"value":["18.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/react"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["react.min.js","react-dom.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactwidget"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/react-tools"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["react-tools.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactR"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactable"]},{"type":"character","attributes":{},"value":["0.4.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.4.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["reactable-binding"]},{"type":"character","attributes":{},"value":["0.4.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["reactable"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.4.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-bundle"]},{"type":"character","attributes":{},"value":["5.16.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-bundle-5.16.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-bundle.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["d3-lasso"]},{"type":"character","attributes":{},"value":["0.0.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/d3-lasso-0.0.5"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["d3-lasso.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["save-svg-as-png"]},{"type":"character","attributes":{},"value":["1.4.17"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/save-svg-as-png-1.4.17"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["save-svg-as-png.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["flatbush"]},{"type":"character","attributes":{},"value":["4.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/flatbush-4.0.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["flatbush.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ggiraphjs"]},{"type":"character","attributes":{},"value":["0.4.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/ggiraphjs-0.4.6"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraphjs.min.js"]},{"type":"character","attributes":{},"value":["ggiraphjs.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["girafe-binding"]},{"type":"character","attributes":{},"value":["0.8.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["girafe.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["ggiraph"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.8.7"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71]}},"value":[{"type":"character","attributes":{},"value":["base","bslib","cachem","cli","colorspace","compiler","datasets","digest","dplyr","ellipsis","evaluate","fansi","fastmap","forcats","generics","ggiraph","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","lifecycle","lubridate","magrittr","memoise","methods","mime","munsell","pillar","pkgconfig","promises","purrr","R6","Rcpp","reactable","reactR","readr","rlang","rmarkdown","rstudioapi","sass","scales","shiny","stats","stringi","stringr","systemfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","uuid","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.3.1","0.5.1","1.0.8","3.6.1","2.1-0","4.3.1","4.3.1","0.6.33","1.1.3","0.3.2","0.21","1.0.4","1.1.1","1.0.0","0.1.3","0.8.7","3.4.3","1.6.2","4.3.1","4.3.1","4.3.1","0.3.4","1.1.3","0.5.6","1.6.2","1.6.11","0.1.4","1.8.7","1.44","1.3.1","1.0.3","1.9.2","2.0.3","2.0.1","4.3.1","0.12","0.5.0","1.9.0","2.0.3","1.2.1","1.0.2","2.5.1","1.0.11","0.4.4","0.5.0","2.1.4","1.1.1","2.24","0.15.0","0.4.7","1.2.1","1.7.5","4.3.1","1.7.12","1.5.0","1.0.4","3.2.1","1.3.0","1.2.0","2.0.0","0.2.0","4.3.1","0.4.0","1.2.3","4.3.1","1.1-1","0.6.3","2.5.0","0.40","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>